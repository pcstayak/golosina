<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Golosina - Guided Online Learning Of Singing, Improving Notes & Articulation</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Landing Page -->
        <div class="landing-page" id="landingPage">
            <div class="header-buttons">
                <button class="header-btn settings-btn" onclick="openSettings()" title="Settings">‚öô</button>
            </div>
            
            <div class="header">
                <h1>GOLOSINA</h1>
                <p>Golosina - Guided Online Learning Of Singing, Improving Notes & Articulation</p>
                <small>Absolutely not vibe coded during lunch break</small>
            </div>

            <div class="sets-grid" id="setsGrid">
                <!-- Exercise sets will be dynamically inserted here -->
            </div>
        </div>

        <!-- Lesson Practice Page -->
        <div class="lesson-page hide" id="lessonPage">
            <div class="header-buttons">
                <button class="header-btn abandon-btn" onclick="abandonLesson()" title="Abandon Lesson">‚ùå</button>
                <button class="header-btn settings-btn" onclick="openSettings()" title="Settings">‚öô</button>
            </div>
            

            <div class="set-header-info" style="--set-color: #667eea;">
                <h2 id="setTitle">Exercise Set</h2>
                <p id="setDescription">Practice vocal exercises</p>
            </div>

            <div class="exercise-section">
                <div class="exercise-nav">
                    <button class="nav-btn" onclick="previousExercise()" id="prevBtn">
                        ‚¨Ö Previous
                    </button>
                    <div class="exercise-counter" id="exerciseCounter">
                        1 of 5
                    </div>
                    <button class="nav-btn" onclick="nextExercise()" id="nextBtn">
                        Next ‚û°
                    </button>
                    <button class="nav-btn" onclick="showRecap()" id="showRecapBtn" style="display: none;">
                        üö™ Recap
                    </button>
                </div>

                <div class="exercise-header">
                    <h2 class="exercise-title" id="exerciseTitle">Breathing Exercise</h2>
                    <p class="exercise-description" id="exerciseDescription">
                        Diaphragmatic breathing technique to improve breath control and support.
                    </p>
                </div>
            </div>

            <div class="recording-section">
                <button class="record-btn" id="recordBtn" onclick="toggleRecording()">üé§</button>
                <div class="status-display status-idle" id="statusDisplay">
                    Ready to record
                </div>
                <div class="progress-bar" id="progressBar" style="display: none;">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>

            <div class="audio-pieces" id="audioPieces">
                <h3>Audio Pieces</h3>
                <div class="empty-state" id="emptyState">
                    No audio pieces recorded for this exercise yet.
                </div>
            </div>
        </div>

        <!-- Recap Page -->
        <div class="recap-page" id="recapPage">
            <div class="header-buttons">
                <button class="header-btn settings-btn" onclick="openSettings()" title="Settings">‚öô</button>
            </div>

            <div class="recap-header">
                <h1>Lesson Recap</h1>
                <p>Review all your recorded vocal exercises</p>
            </div>


            <div class="recap-controls">
                <button class="back-to-lessons-btn" id="backToLessonBtn" onclick="hideRecap()">
                    ‚Üê Back to Lesson
                </button>
                <button class="download-all-btn" onclick="downloadAllPieces()" id="downloadAllBtn">
                    üì• Download All
                </button>
                <button class="btn danger" onclick="endSession()" id="endSessionBtnRecap">
                    üö™ End Lesson
                </button>
                <button class="btn" onclick="shareLesson()" id="shareBtnRecap">
                    üîó Share
                </button>
            </div>

            <div class="share-result" id="shareResult" style="display: none;">
                <div class="share-result-content">
                    <h3>üîó Lesson Uploaded Successfully!</h3>
                    <p>Copy the link below to share with your friends!</p>
                    <div class="share-link-container">
                        <input type="text" id="shareLink" class="share-link-input" readonly>
                        <button class="btn" onclick="copyShareLink()">üìã Copy</button>
                    </div>
                </div>
            </div>

            <div id="recapContent">
                <!-- Dynamic lesson sections will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="close-btn" onclick="closeSettings()">&times;</button>
            </div>

            <div class="settings-group">
                <h3>Audio Settings</h3>
                <div class="form-row">
                    <label>Microphone:</label>
                    <select id="microphoneSelect">
                        <option value="">Select microphone...</option>
                    </select>
                </div>
                <div class="form-row">
                    <label>Sample Rate:</label>
                    <select id="sampleRateSelect">
                        <option value="22050">22.05 kHz (Low Quality)</option>
                        <option value="44100" selected>44.1 kHz (Standard)</option>
                        <option value="48000">48 kHz (High Quality)</option>
                    </select>
                </div>
            </div>

            <div class="settings-group">
                <h3>Silence Detection</h3>
                <div class="form-row">
                    <label>Threshold:</label>
                    <input type="range" id="silenceThreshold" min="0.001" max="0.1" step="0.001" value="0.01">
                    <span class="range-value" id="thresholdValue">0.01</span>
                </div>
                <div class="form-row">
                    <label>Min Duration:</label>
                    <input type="range" id="silenceDuration" min="0.1" max="2.0" step="0.1" value="0.5">
                    <span class="range-value" id="durationValue">0.5s</span>
                </div>
            </div>

            <div class="settings-group">
                <input type="file" id="importFile" accept=".json" style="display: none;" onchange="handleFileImport(event)">
                
                <div class="json-editor-section">
                    <h4>Exercise Management</h4>
                    <div class="json-editor-controls">
                        <button class="btn small" onclick="loadJsonEditor()">üìù Load Current</button>
                        <button class="btn small" onclick="saveFromJsonEditor()">üíæ Apply</button>
                        <button class="btn small secondary" onclick="formatJson()">üîß Format</button>
                        <button class="btn" onclick="importExercises()">üìÅ Import</button>
                    <button class="btn" onclick="exportExercises()">üíæ Export</button>
                    </div>
                    <textarea id="jsonEditor" class="json-editor" placeholder="Exercise sets JSON will appear here..."></textarea>
                </div>
            </div>

            <div class="settings-group">
                <h3>Test Recording</h3>
                <div class="test-section">
                    <button class="btn" id="testRecordBtn" onclick="testRecord()">üé§ Test Record</button>
                    <div id="testStatus" style="margin-top: 10px; font-size: 0.9rem; color: #666;"></div>
                </div>
            </div>
        </div>

    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lamejs/1.2.0/lame.min.js"></script>
    
    <!-- Application Code -->
    <script src="app.js"></script>
    </div>

    
</html>
